

在C++中，`static` 关键字在**全局作用域**和**函数（包括主函数）内部**的使用有不同含义，以下是详细解释：

---

### **1. 全局作用域中的 `static`**
- **作用**：将变量或函数的**链接性（linkage）限制为内部**（仅当前文件可见），避免与其他文件中的同名标识符冲突。
- **示例**：
  ```cpp
  // file1.cpp
  static int globalVar = 42;  // 其他文件无法通过 extern 访问此变量
  static void func() {}       // 仅当前文件可见

  // file2.cpp
  extern int globalVar;       // ❌ 链接错误（无法访问file1中的static全局变量）
  ```

---

### **2. 函数内部的 `static`（包括主函数）**
- **作用**：声明**静态局部变量**，其生命周期为整个程序运行期间，但作用域仍限于函数内。
- **特性**：
  - **初始化仅一次**：在第一次调用函数时初始化。
  - **保留值**：函数多次调用时，变量保持上次结束时的值。
- **示例**：
  ```cpp
  #include <iostream>
  void counter() {
      static int count = 0;  // 静态局部变量
      count++;
      std::cout << "调用次数：" << count << std::endl;
  }
  int main() {
      counter();  // 输出1
      counter();  // 输出2
      return 0;
  }
  ```

---

### **对比总结**
| **场景**       | **全局作用域**                     | **函数内部**                     |
|----------------|-----------------------------------|---------------------------------|
| **作用**       | 限制标识符的链接性（文件内可见）   | 延长局部变量的生命周期           |
| **初始化时机** | 程序启动时初始化                  | 第一次调用函数时初始化            |
| **典型用途**   | 封装模块内部实现，避免命名冲突     | 计数器、缓存、单例模式等场景      |

